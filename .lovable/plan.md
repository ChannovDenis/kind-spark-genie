

# План улучшений демо Добросервис 2.0

## Цель
Добавить 4 ключевых улучшения для более убедительной демонстрации платформы команде, сохраняя лаконичность интерфейса.

---

## 1. Модалка «Записать заключение» в сессии эксперта

**Файл:** `src/pages/expert/Session.tsx`

**Что добавляем:**
- Кнопка «Записать заключение» в header сессии (рядом с Settings)
- Модалка с формой:
  - Выпадающий список шаблонов (Консультация, Направление к специалисту, Общее заключение)
  - Textarea с автозаполнением из шаблона
  - Поле «Рекомендации»
  - Кнопки: Сохранить черновик / Завершить и отправить

**Интерактивность:**
- Выбор шаблона заполняет textarea базовым текстом
- Кнопка «Завершить» закрывает сессию и показывает toast

---

## 2. Страница разбора диалога в Quality Center

**Новый файл:** `src/pages/quality/DialogReview.tsx`

**Трёхколоночный layout:**

```text
+------------------+------------------------+------------------+
|   Инфо о сессии  |       Переписка        |   Инструменты    |
|                  |                        |                  |
|  - Пользователь  |  [AI]: Здравствуйте... |  Оценка: ★★★★☆   |
|  - Сервис        |  [User]: ...           |                  |
|  - Дата/время    |  [AI]: ❌ Проблема     |  Категория:      |
|  - AI Score      |        тут             |  [Dropdown]      |
|                  |                        |                  |
|  Статистика:     |                        |  Комментарий:    |
|  - Токенов       |                        |  [Textarea]      |
|  - Время ответа  |                        |                  |
|                  |                        |  [Отправить в    |
|                  |                        |   дообучение]    |
+------------------+------------------------+------------------+
```

**Интерактивность:**
- Клик по сообщению AI выделяет его как проблемное
- Dropdown для категоризации ошибки (Неточность, Галлюцинация, Недостаток эмпатии, Нарушение протокола)
- Кнопка «В дообучение» показывает toast

**Роутинг:** `/quality/dialogs/:id`

---

## 3. Таймер сессии в реальном времени

**Файл:** `src/pages/expert/Session.tsx`

**Что меняем:**
- Статичный `12:34` заменяем на работающий таймер
- Таймер стартует при загрузке страницы
- Формат: `MM:SS`
- Останавливается при завершении звонка

**Реализация:**
```tsx
const [seconds, setSeconds] = useState(0);
useEffect(() => {
  if (!isCallActive) return;
  const interval = setInterval(() => setSeconds(s => s + 1), 1000);
  return () => clearInterval(interval);
}, [isCallActive]);
```

---

## 4. Toast-уведомления при переключении тенанта

**Файл:** `src/components/shared/TenantSelector.tsx`

**Что добавляем:**
- При смене тенанта показываем toast: «Переключено на [Название тенанта]»
- Используем уже установленный `sonner`

**Реализация:**
```tsx
import { toast } from 'sonner';

const handleTenantChange = (tenant: Tenant) => {
  setCurrentTenant(tenant);
  toast.success(`Переключено на ${tenant.name}`);
};
```

---

## Структура изменений

| Компонент | Действие | Сложность |
|-----------|----------|-----------|
| `Session.tsx` | + Модалка заключения, + таймер | Средняя |
| `DialogReview.tsx` | Новая страница | Средняя |
| `App.tsx` | + маршрут `/quality/dialogs/:id` | Простая |
| `TenantSelector.tsx` | + toast при смене | Простая |
| `Quality Dashboard` | + ссылки на DialogReview | Простая |

---

## Результат

После реализации демо будет показывать:
1. **Полный цикл эксперта** — от начала сессии до записи заключения
2. **Workflow качества** — от списка проблемных диалогов до разбора конкретного
3. **Живой таймер** — ощущение реального приложения
4. **Обратная связь** — toast при действиях пользователя

Все улучшения минимальны по коду, но значительно повышают «живость» демо.

